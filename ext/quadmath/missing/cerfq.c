// Written by Takuya Ooura
#include <quadmath.h>

__complex128
cerfq(__complex128 x)
{
	const __float128
	p0 = 1.1283791670955125738961589031215451717e+00Q,
	p1 =-3.7612638903183752463205296770718172390e-01Q,
	p2 = 1.1283791670955125738961589031215451717e-01Q,
	p3 =-2.6866170645131251759432354836227265993e-02Q,
	p4 = 5.2239776254421878421118467737108572763e-03Q,
	p5 =-8.5483270234508528325466583569814028158e-04Q,
	p6 = 1.2055332981789664251027338708563516792e-04Q,
	p7 =-1.4925650358406250977462419353459592218e-05Q,
	p8 = 1.6462114365889247401612962522198079652e-06Q,
	p9 =-1.6365844691234924317393003677039026555e-07Q,
	p10 = 1.4807192815879217239546050945892452597e-08Q,
	p11 =-1.2290555301717927352982888136906778836e-09Q,
	p12 = 9.4227590646504109706202142382951971074e-11Q,
	p13 =-6.7113668551641103779346255258512799910e-12Q;
	
	if (fabsq(crealq(x))+fabsq(cimagq(x)) > 0.125)
		if (crealq(x) >= 0)
			return 1.q-cerfcq(x);
		else
			return cerfcq(-x)-1.q;
	else
	{
		__complex128 y = x * x;
		return (((((((((((((p13*y+p12)*y+p11)*y+p10)*y
		       +p9)*y+p8)*y+p7)*y+p6)*y+p5)*y+p4)*y
		       +p3)*y+p2)*y+p1)*y+p0)*x;
	}
}
